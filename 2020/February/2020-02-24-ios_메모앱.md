## 2020.02.24(ì›”)

######  iOS MemoApp ë§Œë“¤ë©° ê³µë¶€



#### TableView ë¥¼ êµ¬í˜„í•˜ë©°, Delegate Pattern ì´í•´í•˜ê¸°

##### # TableView êµ¬í˜„ ë‹¨ê³„

> 1. í…Œì´ë¸”ë·°ë¥¼ Sceneì— ë°°ì¹˜ (Storyboard)
> 2. í”„ë¡œí† íƒ€ì… ì…€ ë””ìì¸, ì…€ ì•„ì´ë´í‹°íŒŒì´ì–´ ì§€ì •(ì¤‘ìš”!)
> 3. ë°ì´í„° ì†ŒìŠ¤, ë¸ë¦¬ê²Œì´íŠ¸ ì—°ê²° ğŸ‘‰ TableView Controllerê°€ ìë™ìœ¼ë¡œ ì‹¤í–‰ ì‹œì¼œì¤Œ
> 4. ë°ì´í„° ì†ŒìŠ¤ êµ¬í˜„
> 5. ë¸ë¦¬ê²Œì´íŠ¸ êµ¬í˜„



##### # UITableViewDataSource

- TableViewì— ë°ì´í„°ë¥¼ í‘œì‹œí•˜ëŠ” ë° í•„ìš”í•œ ë‹¤ì–‘í•œ ë©”ì†Œë“œê°€ ì„ ì–¸ë˜ì–´ ìˆìŒ.

- TableViewëŠ” ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ ë””ìì¸ìœ¼ë¡œ ëª‡ê°œë¡œ ì¶œë ¥í•´ì•¼í• ì§€ ëª¨ë¦„.  ğŸ‘‰ Data Sourceë¥¼ í†µí•´ ë¬¼ì–´ë´„.

  - Data Sourceì— êµ¬í˜„ë˜ì–´ ìˆëŠ” ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ì„ í†µí•´ ë¬¼ì–´ë´„.

  - ëŒ€ë‹µì€ ? **Return ê°’**ìœ¼ë¡œ 

    ```swift
    // ëª‡ê°œì˜ ì…€?
    override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
      return Memo.tempMemoList.count
    }
    
    // ì–´ë–¤ ë””ìì¸? ì–´ë–¤ ë°ì´í„°?
    // ê°œë³„ì…€ì„ í˜¸ì¶œ í•  ë•Œë§ˆë‹¤ ë°˜ë³µì ìœ¼ë¡œ í˜¸ ğŸ‘‰ indexPathë¥¼ í†µí•´
    override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
      //ì…€ ë””ìì¸ ê°€ì ¸ì˜´
      let cell = tableView.dequeueReusableCell(withIdentifier: "cell", for: indexPath)
      
      //ì…€ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì…€ì— ì¶œë ¥í•´ì¤Œ.
      let curData = Memo.tempMemoList[indexPath.row]
      cell.textLabel?.text = curData.contentcell.detailTextLabel?.text = curData.date.description
      
      return cell
    }
    ```



##### # Delegate

- Data SourceëŠ” í•„ìˆ˜ì§€ë§Œ, DelegateëŠ” í•„ìˆ˜ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤ë©´, êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ ê´œì°®ìŒ.

  

##### # TableView ë°ì´í„°ì†ŒìŠ¤, ë¸ë¦¬ê²Œì´íŠ¸ ì—°ê²° ì§ì ‘ í•´ë³´ê¸°



#### Date Formatter

- `í´ë¡œì €`ë¥¼ í™œìš©í•´ ì´ˆê¸°í™”

  ```swift
  let formatter: DateFormatter = {
    let format = DateFormatter()
    format.dateStyle = .long
    format.timeStyle = .short
    return format
  }()
  
  formatter.string(from: curData.date)//ì´ë ‡ê²Œ ì¶œë ¥ !
  ```



#### Segue

- sceneì‚¬ì´ì˜ ì „í™˜
- ì—°ê²° ë°©ì‹ì— ë”°ë¼ ì•„ì´ì½˜ ë³€ê²½
- `Presentation` ëª¨ë“œì— ë”°ë¼ -> Full Screen / Page sheet ë“± ìˆìŒ



#### TextField / TextView

> í•œì¤„ ì…ë ¥: Text Field
>
> ì—¬ëŸ¬ì¤„ ì…ë ¥: Text View

- UIViewControllerì—ì„œ TextViewì˜ textê°€ì ¸ì˜¤ê¸°

  ```swift
  @IBAction func clickSave(_ sender: Any) {
    guard let text = memoTextView.text,
    text.count > 0 else{
      //ê²½ê³ ì°½ í‘œì‹œ
      return
    }
  }
  ```

  ğŸ‘‰ `guard let`ì‚¬ìš©: `if` ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·. í•˜ì§€ë§Œ `guard` ë¬¸ì€ ë­”ê°€ë¥¼ ê²€ì‚¬í•˜ì—¬ ê·¸ ë‹¤ìŒì— ì˜¤ëŠ” ì½”ë“œë¥¼ ì‹¤í–‰í• ì§€ ë§ì§€ ê²°ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ, guardë¬¸ì— ì£¼ì–´ì§„ ì¡°ê±´ë¬¸ì´ ê±°ì§“ì´ ë  ë•Œ `else`ì˜ ì½”ë“œ ë¸”ëŸ­ì´ ì‹¤í–‰ë˜ë„ë¡ í•¨. 



#### ê²½ê³ ì°½ ë„ìš°ê¸°

> Alert View : í™”ë©´ ì¤‘ì•™ì— ëœ¸ - ê°„ë‹¨í•œ ì •ë³´/ ë‘ì§€ ì˜µì…˜ì¤‘ì—ì„œ í•˜ë‚˜ ì„ íƒí•  ë•Œ
>
> Action Sheet : ì•„ë˜ì—ì„œ ìœ„ë¡œ sheetê°€ ëœ¸ - 3ê°œì´ìƒì˜ ì˜µì…˜ ì¤‘ì—ì„œ í•˜ë‚˜ ì„ íƒí•  ë•Œ

```swift
extension UIViewController {
    func alert(title: String = "ì•Œë¦¼", message: String){
        let alert = UIAlertController(title: title, message: message, preferredStyle: .alert)
        
        let okAction = UIAlertAction(title: "í™•ì¸", style: .default, handler: nil)
        alert.addAction(okAction)
        
        present(alert, animated: true, completion: nil)
    }
}

```

ğŸ‘‰ ì¬ì‚¬ìš©ì´ ë§ì´ ë˜ëŠ” ì½”ë“œë¡œ, extension ìœ¼ë¡œ ì½”ë“œ ì‘ì„±



#### ViewController

í™”ë©´ì—ì„œ ë°œìƒí•˜ëŠ” ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë°, ì´ë•Œë§ˆë‹¤ override ë©”ëª¨ìŠ¤ ì‹¤í–‰ë¨

```swift
override func viewDidLoad() {
  super.viewDidLoad()
}
```

ğŸ‘‰ Viewcontrollerê°€ ìƒì„±ëœ í›„ì— ìë™ìœ¼ë¡œ í˜¸ì¶œë¨. ì£¼ë¡œ í•œë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” ì´ˆê¸°í™” ì½”ë“œë¥¼ ì—¬ê¸°ì—ì„œ êµ¬í˜„í•¨.



- View ê°€ í™”ë©´ì— í‘œì‹œë˜ëŠ” ì´ë²¤íŠ¸ ë§ˆë‹¤ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜

  viewê°€ í™”ë©´ì— í‘œì‹œë˜ê¸° ì§ì „ì— ìë™ìœ¼ë¡œ í˜¸ì¶œ

  ```swift
  override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)
  }
  ```



#### ìƒˆë¡œìš´ ë©”ëª¨ë¥¼ updateí•´ì£¼ëŠ” ì‹œì 

ğŸ‘‰ ë©”ëª¨ ì‘ì„±í•˜ëŠ” ì°½ì´ ì‚¬ë¼ì§€ê³ , ë©”ëª¨ ë¦¬ìŠ¤íŠ¸ê°€ ë–´ì„ ë•Œ ì—…ë°ì´íŠ¸

```swift
 override func viewWillAppear(_ animated: Bool) {
   super.viewWillAppear(animated)
   tableView.reloadData()
   print(#function)
 }
```

í•˜ì§€ë§Œ, **ios12** ê±°ë‚˜ presentationì´ **full screen**ì´ë¼ë©´ ì´ì™€ê°™ì´ ì²˜ë¦¬í• ìˆ˜ ìˆì§€ë§Œ, 

ios13ì—ì„œ ê¸°ë³¸ê°’ì¸ sheetë¡œ í‘œì‹œí•œë‹¤ë©´ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì´ ë‹¬ë¼ì§.

ğŸ‘‰ viewWillAppearì´ í˜¸ì¶œë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ë°©ì‹ í•„ìš”. `Notification`ì„ ì‚¬ìš©í•¨.

ë©”ëª¨ê°€ ì €ì¥ë˜ë©´ `notification` ì „ë‹¬. ê·¸ë¦¬ê³  ëª©ë¡í™”ë©´ì€ `notification` ì´ ì „ë‹¬ë˜ëŠ” ì‹œì ì— tableView ì—…ë°ì´íŠ¸



#### Notification

> ë¼ë””ì˜¤ ë°©ì†¡ì´ë¼ê³  ìƒê°í•˜ë©´ ë¨. 
>
> ë¼ë””ì˜¤ ë°©ì†¡êµ­ì— í•´ë‹¹í•˜ëŠ” ë¼ë””ì˜¤ ì„¼í„°ê°€ ìˆìŒ. ë¼ë””ì˜¤ ë°©ì†ì€ ì£¼íŒŒìˆ˜ë¥¼ í†µí•´ êµ¬ë¶„í•˜ë“¯, ë…¸í‹°í”¼ì¼€ì´ì…˜ì€ ì´ë¦„ìœ¼ë¡œ êµ¬ë¶„.

```swift
extension NewMemoViewController{
    static let saveNewMemo = Notification.Name(rawValue: "saveNewMemo")
}
```

```swift
NotificationCenter.default.post(name: NewMemoViewController.saveNewMemo, object: nil)
```

ğŸ‘‰ ì´ ì½”ë“œëŠ” ë¼ë””ì˜¤ë°©ì†¡êµ­ì—ì„œ, ë¼ë””ì˜¤ë°©ì†ì„ ë¸Œë¡œë“œìºìŠ¤íŠ¸ í•˜ëŠ” ê²ƒê³¼ ê°™ìŒ.

`notification`ì€ íŠ¹ì • ê°ì²´ì—ê²Œ ë°”ë¡œ ì „ë‹¬ë˜ì§€ ì•Šê³ (unicast), `broadcast` ë¡œ ì•±ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ê°ì²´ë“¤ì—ê²Œ ì „ë‹¬ë¨. 

ğŸ‘‰ ì „ë‹¬ë°›ì€ notificationì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ì˜µì ¸ë²„ë¥¼ ë“±ë¡í•˜ê³ , í•„ìš”í•œ ì½”ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•¨. (ë¼ë””ì˜¤ ì£¼íŒŒìˆ˜ë¥¼ ë§ì¶”ëŠ” ê²ƒì— ë¹„ìœ í•  ìˆ˜ ìˆìŒ.)



#### Observer(ì˜µì €ë²„)

> Observer Patternì€ í•´ë‹¹ í”„ë¡œí¼í‹°ê°€ ë³€ê²½ë˜ëŠ” ê²ƒì„ ê´€ì°°í•˜ê³  ìˆë‹¤ê°€ ë³€ê²½ë˜ëŠ” ì‹œì ì—ì„œ updateê°€ ìˆ˜í–‰ë˜ê²Œ ë˜ëŠ” í˜•íƒœë¥¼ ë§í•¨.
>
> ğŸ‘‰ í•œ ëŒ€ìƒì„ ë³´ê³  ìˆë‹¤ê°€ ê·¸ ëŒ€ìƒì´ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ë¥¼ ë³´ê³  ìˆë‹¤ê°€ ê·¸ ëŒ€ìƒì´ ë³€í™”ê°€ ì¼ì–´ë‚˜ë©´ í–‰ë™ì„ í•˜ëŠ” ê²ƒ.

ì˜µì €ë²„ë¥¼ ì¶”ê°€í•˜ëŠ” ì½”ë“œëŠ” í•œë²ˆë§Œ ì‹¤í–‰í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì—, ë³´í†µ viewDidLoad ì—ì„œ êµ¬í˜„.

```swift
NotificationCenter.default.addObserver(forName: NewMemoViewController.saveNewMemo, object: nil, queue: OperationQueue.main) { [weak self](noti) in                                                                                                                          self?.tableView.reloadData()
}
// UIì—…ë°ì´íŠ¸ëŠ” ë©”ì¸ ì“°ë ˆë“œì—ì„œ í•´ì•¼í•¨ â€¼ï¸
// iosì—ì„œëŠ” ì“°ë ˆë“œë¥¼ ì§ì ‘ ì²˜ë¦¬í•˜ì§€ ì•Šê³ , Dispatch Queue ë‚˜ Operation Queueë¥¼ í†µí•´ì„œ ì²˜ë¦¬
```

- **ì˜µì €ë²„ í•´ì²´**í•´ì•¼í•¨ ! -> **ë©”ëª¨ë¦¬ ë‚­ë¹„ ë¬¸ì œ** ë•Œë¬¸.

- ```swift
  var token : NSObjectProtocol?
  
  ///addObserver -> observerë¥¼ í•´ì§€í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë¥¼ return í•¨ 
  // ë”°ë¼ì„œ tokenì— ì €ì¥í•´ë‘ .
  token = NotificationCenter.default.addObserver(forName: NewMemoViewController.saveNewMemo, object: nil, queue: OperationQueue.main) { [weak self](noti) in                                                                                                                                   		self?.tableView.reloadData()                                                                                                                                   }
  ///
  
  // ğŸ‘‰ ì†Œë©¸ìì—ì„œ í•´ì²´
  deinit {
    if let token = token {
      NotificationCenter.default.removeObserver(token)
    }
  }
  ```

  viewDidLoadì—ì„œ ì¶”ê°€í•œ ì˜µì €ë²„ëŠ” í™”ë©´ì—ì„œ ì‚¬ë¼ì§€ê¸° ì „ì— í•´ì§€í•˜ê±°ë‚˜ ì†Œë©¸ìì—ì„œ í•´ì œ

  

#### ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ë©´ iOS13ì— ë§ì¶°ì ¸ ìˆì–´, ê·¸ ì´í•˜ ë²„ì „ì—ì„œ ì‘ë™ X

ìƒˆ ë©”ëª¨ì°½ì„ sheetë¡œ ë§Œë“¤ì—ˆëŠ”ë° iOS12ì—ì„œëŠ” ì‘ë™ì´ ì•ˆë¨.

- AppDelegateì—ì„œ windowì†ì„± ì¶”ê°€

  ```swift
  var window: UIWindow?
  ```

ğŸ‘‰ iOS13 ë°‘ ë²„ì „ì—ì„œëŠ” full screenìœ¼ë¡œ ëœ¨ê³ , iOS13ìœ„ ë²„ì „ë¶€í„°ëŠ” sheetë¡œ ëœ¸.



##### ë‹¨ì¶•í‚¤

- Command + K : ë””ë°”ì´ìŠ¤ ë‚´ í‚¤ë³´ë“œ ì—´ì—ˆë‹¤ ë‹«ì•˜ë‹¤

  