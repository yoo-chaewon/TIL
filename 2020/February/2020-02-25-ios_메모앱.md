## 2020.02.25(í™”)

######  iOS MemoApp ë§Œë“¤ë©° ê³µë¶€



#### í™”ë©´ì „í™˜ with NavigationController

navigationcontrollerì—ì„œëŠ” push/ popì„ ì´ìš©í•´ì„œ ì²˜ë¦¬í•´ì¤Œ.

> Push: ìƒˆë¡œìš´ í™”ë©´ì´ ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œ
>
> Pop: ì´ì „ë²„íŠ¼ ëˆ„ë¥´ë©´ ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œ ë˜ë©´ì„œ í™”ë©´ì´ ì‚¬ë¼ì§.



#### ë°ì´í„° ì „ë‹¬(Segueë¡œ ì—°ê²°ëœ í™”ë©´ì—ì„œ ë°ì´í„° ì „ë‹¬í•  ê²½ìš°)

- SegueëŠ” ì—°ê²°ëœ í™”ë©´ì„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤Œ.

- navigation controllerê°€ ìë™ìœ¼ë¡œ pushí•´ì¤Œ. 

- í•˜ë‚˜ì˜ í™”ë©´ì—ì„œ ë‹¤ë¥¸ í™”ë©´ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆëŠ”ë°, ê°€ì¥ ê¸°ë³¸ì ì¸ íŒ¨í„´ì„ ì‚¬ìš©í•  ê²ƒì„.  

  > segueëŠ” í™”ë©´ì „í™˜ì„ ë§Œë“¤ê³  
  >
  > í™”ë©´ì „í™˜ì´ ì‹œì‘ë˜ê¸° ì „ì— íŠ¹ë³„í•œ ë©”ì†Œë“œë¥¼ í˜¸ì¶œ í•¨
  >
  > ğŸ‘‰ ì—¬ê¸°ì„œ ì„ íƒí•œ ë©”ëª¨ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•  ê²ƒì„

```swift
override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
}
```

ğŸ‘‰ ì´ ë©”ì†Œë“œëŠ” segueê°€ ì—°ê²°ëœ í™”ë©´ì„ ìƒì„±í•˜ê³  í™”ë©´ì„ ì „í™˜í•˜ê¸° ì§ì „ì— í˜¸ì¶œí•¨.

- `sender` ë¥¼ í™œìš©í•´ì„œ ëª‡ë²ˆì§¸ ì…€ì„ ì„ íƒí–ˆëŠ”ì§€ ì „ë‹¬í•´ì•¼í•¨.

```swift
override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
  if let cell = sender as? UITableViewCell, // Any typeì´ê¸° ë•Œë¬¸ì— í˜•ë³€í™˜
  let indexPath = tableView.indexPath(for: cell){
    if let vc = segue.destination as? DetailViewController{//ì‹¤ì œí˜•ì‹ìœ¼ë¡œ í˜•ë³€í™˜
      vc.memo = Memo.tempMemoList[indexPath.row]//DetailViewControllerì˜ dataë¡œ ì „ë‹¬
    }
  }
}
```

**Segue** ğŸ‘‰ ëª©ë¡ í™”ë©´ê³¼ ë³´ê¸°í™”ë©´ ì ‘ê·¼ ê°€ëŠ¥

> segue.source : segueë¥¼ ì‹¤í–‰í•˜ëŠ” í™”ë©´
>
> Segue.destination: ìƒˆë¡­ê²Œ í‘œì‹œë˜ëŠ” í™”ë©´



#### Self-Sizig Cell

tableViewëŠ” Cellì— í‘œì‹œë˜ëŠ” ë‚´ìš©ì— ë§ê²Œ Cellë†’ì´ë¥¼ ìë™ìœ¼ë¡œ ì¡°ì ˆí•¨.

> TableView Size inspector
>
> Row Height / Estimate ğŸ‘‰ Automatic ì²´í¬



#### Label ë¼ì¸ ìˆ˜ ì„¤ì •

- `Lines` ì„¤ì • -> 1......(0ìœ¼ë¡œ í•˜ë©´ ë¼ì¸ ìˆ˜ ìƒê´€ ì—†ì´ ëª¨ë“  text ì¶œë ¥)

  > labelì€ ê¸°ë³¸ì ìœ¼ë¡œ í•œì¤„ì— í‘œì‹œí•˜ê³ , í•œì¤„ì— í‘œì‹œí•  ìˆ˜ ì—†ë‹¤ë©´ ... ì´ëŸ°ì‹ìœ¼ë¡œ ìƒëµ ğŸ‘‰ `Line Break` ì˜µì…˜

- `Line Break`ë¥¼ `word wrap` ìœ¼ë¡œ ë³€ê²½ ğŸ‘‰ ë‹¨ì–´ ì¤‘ê°„ì—ì„œ ì¤„ë°”ê¿ˆ ë˜ëŠ” ê²½ìš° ì—†ìŒ

  > ì˜ì–´ì—ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ì§€ë§Œ í•œê¸€ì—ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ì‘ë™ X

  

#### DBêµ¬í˜„

> iOSì—ì„œ ë°ì´í„° ë² ì´ìŠ¤ì— ë©”ëª¨ë¥¼ êµ¬í˜„í• ë•ŒëŠ” `Core Data`ì‚¬ìš©
>
> ğŸ‘‰ í”„ë¡œì íŠ¸ ìƒì„±í•  ë•Œ `Core Data` ì˜µì…˜ì„ í´ë¦­í–ˆê¸° ë•Œë¬¸ì— , ê¸°ë³¸ì  íŒŒì¼ ìƒì„±ë˜ì–´ ìˆìŒ.

- `xcdatemodeld` íŒŒì¼ : ë°ì´í„°ë¥¼ ì €ì¥í•  ë°©ì‹ì„ í‘œí˜„í•˜ëŠ” ì„¤ê³„ë„(***ë°ì´í„° ë² ì´ìŠ¤ì˜ ì„¤ê³„ë„***)

  > ì—¬ê¸°ì„œ ë©”ëª¨ê°€ ì–´ë–¤ í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ëŠ”ì§€ ì„¤ê³„ë„ë¥¼ ë§Œë“¤ì–´ì•¼ í•¨.
  >
  > ì—¬ê¸°ì„œ `ENTITIES` ì¶”ê°€(***í…Œì´ë¸”ì˜ ì„¤ê³„ë„***)

- Data inspector ğŸ‘‰ Codegen : `Class Definition`

  > Core Dataë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” Entityë¥¼ Classë¡œ ë‹¤ë¤„ì•¼ í•¨.
  >
  > ğŸ‘‰ ì—¬ê¸°ì— í•„ìš”í•œ DataëŠ” ìë™ìœ¼ë¡œ ìƒì„±ë¨.

- AppDelegate.swift

  ```swift
  // MARK: - Core Data stack
  
  lazy var persistentContainer: NSPersistentContainer = {
    let container = NSPersistentContainer(name: "HiMeMo")
    container.loadPersistentStores(completionHandler: { (storeDescription, error) in
    if let error = error as NSError? {
      fatalError("Unresolved error \(error), \(error.userInfo)")
    	}
    })
    return container
  }()
  ```

  Core Dataë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ê¸°ë³¸ì ì¸ ì½”ë“œ ğŸ‘‰ ì´ê±° ì‚¬ìš© X ğŸ‘‰ ì œê±°í•´ì£¼ê¸°

- `DataManager.swift` 

  ```swift
  import Foundation
  import CoreData
  
  class DataManager {
    //SingleTon ì‚¬ìš©
    //// ì´ë ‡ê²Œ í•˜ë©´ í•˜ë‚˜ì˜ ì•±ì—ì„œ 
    static let shared = DataManager()
      private init(){
          
      }
    ///////
    
    
      // MARK: - Core Data stack
  
      lazy var persistentContainer: NSPersistentContainer = {
          let container = NSPersistentContainer(name: "HiMeMo")
          container.loadPersistentStores(completionHandler: { (storeDescription, error) in
              if let error = error as NSError? {
                  
                  fatalError("Unresolved error \(error), \(error.userInfo)")
              }
          })
          return container
      }()
  
      // MARK: - Core Data Saving support
  
      func saveContext () {
          let context = persistentContainer.viewContext
          if context.hasChanges {
              do {
                  try context.save()
              } catch {
                  // Replace this implementation with code to handle the error appropriately.
                  // fatalError() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development.
                  let nserror = error as NSError
                  fatalError("Unresolved error \(nserror), \(nserror.userInfo)")
              }
          }
      }
  }
  ```

- `ì‹±ê¸€í†¤(Singleton)` ì‚¬ìš©

  ```swift
  // ê³µìœ  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥í•  íƒ€ì… í”„ë¡œí¼í‹° ì¶”ê°€
  static let shared = DataManager()
  //ê¸°ë³¸ ìƒì„±ì ì¶”ê°€ + private ì„ ì–¸ 
  private init(){
  
  }
  ```

  ğŸ‘‰ ì•± ì „ì²´ì—ì„œ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ ê³µìœ í•  ìˆ˜ ìˆìŒ.

  > ì‹±ê¸€í†¤ì€ iOSì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´,

- CoreDataì—ì„œ ì‹¤í–‰í•˜ëŠ” ì‘ì—…ì€ ëŒ€ë¶€ë¶„ Contextê°ì²´ê°€ ë‹´ë‹¹

  > ì§ì ‘ ë§Œë“¤ìˆ˜ë„ ìˆì§€ë§Œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” Context ì‚¬ìš©

  ```swift
  var mainContext: NSManagedObjectContext{
    return persistentContainer.viewContext
  }
  ```

- `SceneDelegate.swift` 

  ```swift
  func sceneDidEnterBackground(_ scene: UIScene) {        
  //(UIApplication.shared.delegate as? AppDelegate)?.saveContext()//ì‚­ì œ
    DataManager.shared.saveContext()//ì¶”ê°€
    //ì‹±ê¸€í†¤ìœ¼ë¡œ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥
  }
  ```

- ë°ì´í„° ë² ì´ìŠ¤ ë°ì´í„° `fetch` + `sort`

  ```swift
  func fetchMemo(){
    let request : NSFetchRequest<Memo> = Memo.fetchRequest()
    let sortByDateDesc = NSSortDescriptor(key: "date", ascending: false)
    request.sortDescriptors = [sortByDateDesc]
    do{
      memoList = try mainContext.fetch(request)
    }catch{
      print(error)
    }
  }
  ```



#### Data Baseì— ì €ì¥

- `DataManager.swift` 

  ```swift
  func saveNewMemo(_memo: String?){
    let newMemo = Memo(context: mainContext)
    //Core Dataê°€ ë§Œë“  Memoí´ë˜ìŠ¤ ì´ë¯€ë¡œ, contextë¥¼ ì „ë‹¬í•´ì•¼í•¨.
    //ë°ì´í„°ë² ì´ìŠ¤ì— ë©”ëª¨ë¥¼ ì €ì¥í•˜ëŠ”ë° í•„ìš”í•œ ë¹„ì–´ìˆëŠ” ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    
    newMemo.date = Date()
    saveContext()
  }
  ```

  



